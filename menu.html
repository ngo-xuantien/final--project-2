<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Menu - TrÃ  Sá»¯a MoMo</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

<header class="header">
  <div class="nav-inner">
    <div class="logo-wrap">
      <div class="logo-dot"></div>
      <span>TrÃ  Sá»¯a MoMo</span>
    </div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="menu.html">Menu</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="login.html">Login</a>
      <a href="admin-products.html" class="badge">Admin</a>
      <button id="open-cart" class="cart-btn">
        ğŸ›’ <span id="cart-count">0</span>
      </button>
    </nav>
  </div>
</header>

<main class="container">
  <div class="section-header">
    <div>
      <h2>Menu nhÃ  MoMo</h2>
      <p>Milk tea, fruit tea, signature & topping Ä‘á»§ cáº£ ğŸ§‹</p>
    </div>
    <div>
      <button class="btn-text" onclick="filterMenu('all')">Táº¥t cáº£</button>
      <button class="btn-text" onclick="filterMenu('milk')">TrÃ  sá»¯a</button>
      <button class="btn-text" onclick="filterMenu('fruit')">TrÃ  trÃ¡i cÃ¢y</button>
      <button class="btn-text" onclick="filterMenu('signature')">Signature</button>
      <button class="btn-text" onclick="filterMenu('topping')">Topping</button>
    </div>
  </div>

  <div style="margin-bottom:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
    <span class="card-sub">Sáº¯p xáº¿p:</span>
    <button class="btn-text" onclick="sortMenu('asc')">GiÃ¡ tÄƒng dáº§n</button>
    <button class="btn-text" onclick="sortMenu('desc')">GiÃ¡ giáº£m dáº§n</button>
    <button class="btn-text" onclick="sortMenu('default')">Máº·c Ä‘á»‹nh</button>
  </div>

  <div id="menu-grid" class="grid">
    <!-- JS render -->
  </div>
</main>

<div id="mini-cart" class="mini-cart">
  <div class="mini-cart-header">
    <strong>Giá» hÃ ng</strong>
    <button class="btn-text" onclick="toggleMiniCart()">ÄÃ³ng</button>
  </div>
  <div class="mini-cart-items"></div>
  <div class="cart-actions">
    <span class="card-sub">Tá»•ng: <strong class="mini-cart-total">0Ä‘</strong></span>
    <button class="btn-text" onclick="clearCart()">XÃ³a háº¿t</button>
    <button class="btn-primary" onclick="checkoutOrder()">Thanh toÃ¡n</button>
  </div>
</div>


<footer class="footer">
  <div class="footer-inner">
    <div>
      <strong>TrÃ  Sá»¯a MoMo</strong><br/>
      65 Nguyá»…n Biá»ƒu, P1, Q5, TP.HCM<br/>
      Hotline: 090-xxx-xxxx
    </div>
    <div style="text-align:right;">
      Follow: Facebook Â· TikTok<br/>
      Giá» má»Ÿ cá»­a: 8:00 - 22:00
    </div>
  </div>
</footer>


<!-- Commit: NÃºt má»Ÿ/Ä‘Ã³ng cá»­a sá»• chat MoMo Bot -->
<button id="chatbot-btn">ğŸ’¬</button>

<!-- Commit: Cá»­a sá»• chat MoMo Bot -->
<div id="chat-window">
  <div id="chat-header">
    <div class="chat-header-left">
      <div class="bot-avatar">ğŸ§‹</div>
      <div>
        <div class="bot-name">MoMo Bot</div>
        <div class="bot-sub">bÃ© MoMo online nÃ¨ ğŸ¤—</div>
      </div>
    </div>
    <button id="voice-toggle" title="Báº­t/Táº¯t giá»ng nÃ³i">ğŸ”ˆ</button>
  </div>

  <div id="chat-body">
    <div class="bot-msg msg-with-avatar">
      <div class="bot-avatar-small">ğŸ§‹</div>
      <div class="msg-bubble">Dáº¡ bÃ© MoMo chÃ ooo ~ Báº¡n muá»‘n há»i gÃ¬ hong nÃ¨? ğŸ’—</div>
    </div>

    <div id="faq-suggestions"></div>

    <div id="typing-indicator" class="typing" style="display:none;">
      MoMo Ä‘ang gÃµ tráº£ lá»i cho báº¡n ...
      <span class="dot"></span><span class="dot"></span><span class="dot"></span>
    </div>
  </div>

  <div id="chat-input-box">
    <input id="chat-input" placeholder="Nháº¯n gÃ¬ Ä‘Ã³ vá»›i bÃ© MoMo nÃ¨..." />
    <button id="chat-send">Gá»­i</button>
  </div>
</div>

<link rel="stylesheet" href="chatbot.css">
<script src="chatbot.js"></script>

<script src="script.js"></script>
<script>
// Commit: LÆ°u toÃ n bá»™ sáº£n pháº©m láº¥y tá»« API
let allProducts = [];
let currentProducts = []; // Commit: danh sÃ¡ch sáº£n pháº©m sau khi filter/sort hiá»‡n táº¡i
let currentFilter = 'all';

// Commit: Render danh sÃ¡ch sáº£n pháº©m ra grid
function renderMenu(list) {
  const grid = document.getElementById('menu-grid');
  grid.innerHTML = '';
  list.forEach(p => {
    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      ${p.tag ? `<span class="card-tag">${p.tag}</span>` : ""}
      <img src="${p.img}" class="card-img" alt="">
      <h3 class="card-title">${p.name}</h3>
      <p class="card-sub">${p.description || 'Má»™t mÃ³n siÃªu xá»‹n tá»« nhÃ  MoMo nÃ¨ ~'}</p>
      <div class="card-bottom">
        <span class="price">${p.price.toLocaleString()}Ä‘</span>
        <button class="btn-primary" onclick="addToCart('${p.id}','${p.name}',${p.price},'${p.img}')">ThÃªm</button>
      </div>
    `;
    grid.appendChild(card);
  });
}

// Commit: Lá»c theo category
function filterMenu(cat) {
  currentFilter = cat;
  if (cat === 'all') {
    currentProducts = [...allProducts];
  } else {
    currentProducts = allProducts.filter(p => p.category === cat);
  }
  renderMenu(currentProducts);
}

// Commit: Sáº¯p xáº¿p theo giÃ¡
function sortMenu(type) {
  let sorted = [...currentProducts];
  if (type === 'asc') {
    sorted.sort((a,b) => a.price - b.price);
  } else if (type === 'desc') {
    sorted.sort((a,b) => b.price - a.price);
  } else {
    // Commit: trá»Ÿ láº¡i thá»© tá»± ban Ä‘áº§u theo filter
    filterMenu(currentFilter);
    return;
  }
  renderMenu(sorted);
}

// Commit: Khi load trang, gá»i API /products
document.addEventListener('DOMContentLoaded', () => {
  fetch(API_URL + '/products')
    .then(res => res.json())
    .then(data => {
      allProducts = data;
      currentProducts = [...allProducts];
      renderMenu(currentProducts);
    })
    .catch(err => {
      console.error(err);
      const grid = document.getElementById('menu-grid');
      grid.innerHTML = '<p class="card-sub">KhÃ´ng táº£i Ä‘Æ°á»£c menu. Nhá»› cháº¡y JSON Server nha bÃ© ~</p>';
    });
});
</script>
</body>
</html>
