<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Login - TrÃ  Sá»¯a MoMo</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>

<header class="header">
  <div class="nav-inner">
    <div class="logo-wrap">
      <div class="logo-dot"></div>
      <span>TrÃ  Sá»¯a MoMo</span>
    </div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="menu.html">Menu</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="login.html">Login</a>
      <a href="admin-products.html" class="badge">Admin</a>
      <button id="open-cart" class="cart-btn">
        ğŸ›’ <span id="cart-count">0</span>
      </button>
    </nav>
  </div>
</header>

<main class="container" style="max-width:480px;">
  <div class="section-header">
    <div>
      <h2>ÄÄƒng nháº­p / ÄÄƒng kÃ½</h2>
      <p>Äá»ƒ MoMo nhá»› báº¡n cho nhá»¯ng láº§n Ä‘áº·t sau nÃ¨ ğŸ’—</p>
    </div>
  </div>
  <section class="card">
    <form id="login-form">
      <input id="email" required placeholder="Email" style="width:100%;padding:8px;border-radius:8px;border:1px solid #eee;margin-bottom:8px;"/>
      <input id="password" required type="password" placeholder="Máº­t kháº©u" style="width:100%;padding:8px;border-radius:8px;border:1px solid #eee;margin-bottom:8px;"/>
      <div style="display:flex;gap:8px;align-items:center;">
        <button class="btn-primary" type="submit">ÄÄƒng nháº­p</button>
        <button class="btn-text" type="button" id="register-btn">ÄÄƒng kÃ½</button>
      </div>
      <p class="card-sub" id="auth-msg" style="margin-top:10px;"></p>
    </form>
  </section>
</main>

<footer class="footer">
  <div class="footer-inner">
    <div>
      <strong>TrÃ  Sá»¯a MoMo</strong><br/>
      65 Nguyá»…n Biá»ƒu, P1, Q5, TP.HCM<br/>
      Hotline: 090-xxx-xxxx
    </div>
    <div style="text-align:right;">
      Follow: Facebook Â· TikTok<br/>
      Giá» má»Ÿ cá»­a: 8:00 - 22:00
    </div>
  </div>
</footer>


<!-- Commit: NÃºt má»Ÿ/Ä‘Ã³ng cá»­a sá»• chat MoMo Bot -->
<button id="chatbot-btn">ğŸ’¬</button>

<!-- Commit: Cá»­a sá»• chat MoMo Bot -->
<div id="chat-window">
  <div id="chat-header">
    <div class="chat-header-left">
      <div class="bot-avatar">ğŸ§‹</div>
      <div>
        <div class="bot-name">MoMo Bot</div>
        <div class="bot-sub">bÃ© MoMo online nÃ¨ ğŸ¤—</div>
      </div>
    </div>
    <button id="voice-toggle" title="Báº­t/Táº¯t giá»ng nÃ³i">ğŸ”ˆ</button>
  </div>

  <div id="chat-body">
    <div class="bot-msg msg-with-avatar">
      <div class="bot-avatar-small">ğŸ§‹</div>
      <div class="msg-bubble">Dáº¡ bÃ© MoMo chÃ ooo ~ Báº¡n muá»‘n há»i gÃ¬ hong nÃ¨? ğŸ’—</div>
    </div>

    <div id="faq-suggestions"></div>

    <div id="typing-indicator" class="typing" style="display:none;">
      MoMo Ä‘ang gÃµ tráº£ lá»i cho báº¡n ...
      <span class="dot"></span><span class="dot"></span><span class="dot"></span>
    </div>
  </div>

  <div id="chat-input-box">
    <input id="chat-input" placeholder="Nháº¯n gÃ¬ Ä‘Ã³ vá»›i bÃ© MoMo nÃ¨..." />
    <button id="chat-send">Gá»­i</button>
  </div>
</div>

<link rel="stylesheet" href="chatbot.css">
<script src="chatbot.js"></script>

<script src="script.js"></script>
<script>
const authMsg = document.getElementById('auth-msg');
const loginForm = document.getElementById('login-form');
const registerBtn = document.getElementById('register-btn');

function setAuthMsg(text) {
  authMsg.textContent = text || '';
}

loginForm.addEventListener('submit', (e) => {
  e.preventDefault();
  setAuthMsg('Äang kiá»ƒm tra thÃ´ng tin...');
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  fetch(API_URL + '/users?email=' + encodeURIComponent(email))
    .then(res => res.json())
    .then(users => {
      if (!users.length) {
        setAuthMsg('KhÃ´ng tÃ¬m tháº¥y tÃ i khoáº£n, báº¡n thá»­ ÄÄƒng kÃ½ giÃºp MoMo nha.');
      } else {
        const u = users[0];
        if (u.password === password) {
          localStorage.setItem('momo_user', JSON.stringify({ id:u.id, email:u.email }));
          setAuthMsg('ÄÄƒng nháº­p thÃ nh cÃ´ng, xin chÃ o ' + u.email + ' ğŸ§‹');
          alert('ÄÄƒng nháº­p thÃ nh cÃ´ng!');
        } else {
          setAuthMsg('Sai máº­t kháº©u rá»“i nÃ¨ ~');
        }
      }
    })
    .catch(err => {
      console.error(err);
      setAuthMsg('KhÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c JSON Server.');
    });
});

registerBtn.addEventListener('click', () => {
  setAuthMsg('Äang táº¡o tÃ i khoáº£n má»›i...');
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  if (!email || !password) {
    setAuthMsg('Báº¡n Ä‘iá»n email vÃ  máº­t kháº©u trÆ°á»›c Ä‘Ã£ nha.');
    return;
  }
  fetch(API_URL + '/users', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ email, password })
  })
    .then(res => res.json())
    .then(u => {
      setAuthMsg('ÄÄƒng kÃ½ thÃ nh cÃ´ng! Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p báº±ng tÃ i khoáº£n nÃ y rá»“i nÃ¨.');
    })
    .catch(err => {
      console.error(err);
      setAuthMsg('KhÃ´ng táº¡o Ä‘Æ°á»£c tÃ i khoáº£n. Kiá»ƒm tra JSON Server giÃºp MoMo nha.');
    });
});
</script>
</body>
</html>
